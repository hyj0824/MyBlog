---
tags:
  - DP
  - 矩阵乘法
date: 2023-09-10
dg-publish: true
dg-permalink: 抓取题目脚本
---


## Flask 监听

当使用Python来实现类似的功能时，您可以使用Flask作为Web框架，并使用Flask内置的JSON解析功能。以下是相当于您提供的Node.js代码的Python版本：

```python
import json
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/', methods=['POST'])
def handle_post():
    data = request.json  # 从请求中获取JSON数据

    # 打印问题的名称和组
    print(f"Problem name: {data['name']}")
    print(f"Problem group: {data['group']}")
    print(f"Problem url: {data['url']}")
    print('Full body:')
    print(json.dumps(data, indent=4))

    return jsonify({"message": "Success"}), 200  # 返回JSON响应

if __name__ == '__main__':
    port = 10043
    app.run(port=port)
```

这个Python代码使用Flask框架创建了一个类似的HTTP服务器。它定义了一个路由处理函数`handle_post`，该函数将在根路径`'/'`上监听POST请求。在这个处理函数中，我们使用`request.json`来获取从客户端发送的JSON数据，然后打印问题的名称、问题组以及整个请求体的JSON表示。最后，它返回一个JSON响应表示成功，并使用状态码200。

请注意，为了运行这个Python代码，您需要首先安装Flask库，可以使用`pip install Flask`来安装。然后，您可以运行这个Python脚本，并服务器将在端口10043上监听传入的请求。


## openpyxl 写入Excel

使用Python库openpyxl可以轻松地创建、追加数据、合并单元格、读取和写入Excel文件。下面是一些基本的操作示例：

1. 创建Excel表格：

```python
from openpyxl import Workbook

# 创建一个新的工作簿
workbook = Workbook()

# 创建一个新的工作表
sheet = workbook.active

# 添加数据到工作表
sheet["A1"] = "姓名"
sheet["B1"] = "年龄"
sheet["A2"] = "Alice"
sheet["B2"] = 25
sheet["A3"] = "Bob"
sheet["B3"] = 30

# 保存工作簿
workbook.save("example.xlsx")
```

2. 追加数据到现有工作表：

```python
from openpyxl import load_workbook

# 打开现有的工作簿
workbook = load_workbook("example.xlsx")

# 选择要追加数据的工作表
sheet = workbook.active

# 追加数据
sheet.append(["Charlie", 22])

# 保存工作簿
workbook.save("example.xlsx")
```

3. 合并单元格：

```python
from openpyxl import Workbook
from openpyxl.worksheet.dimensions import ColumnDimension

# 创建一个新的工作簿和工作表
workbook = Workbook()
sheet = workbook.active

# 合并单元格
sheet.merge_cells("A1:D1")
sheet["A1"] = "合并单元格示例"

# 设置合并后的单元格样式
merged_cell = sheet["A1"]
merged_cell.alignment = openpyxl.styles.Alignment(horizontal='center')

# 保存工作簿
workbook.save("merged_example.xlsx")
```

4. 读入Excel文件：

```python
from openpyxl import load_workbook

# 打开现有的工作簿
workbook = load_workbook("example.xlsx")

# 选择要读取的工作表
sheet = workbook.active

# 读取单元格数据
cell_value = sheet["A1"].value
print(cell_value)
```

5. 写入Excel文件：

```python
from openpyxl import Workbook

# 创建一个新的工作簿和工作表
workbook = Workbook()
sheet = workbook.active

# 写入数据到工作表
sheet["A1"] = "姓名"
sheet["B1"] = "年龄"
sheet["A2"] = "Alice"
sheet["B2"] = 25
sheet["A3"] = "Bob"
sheet["B3"] = 30

# 保存工作簿
workbook.save("new_example.xlsx")
```

这些示例展示了如何使用openpyxl执行常见的Excel操作。你可以根据需要进一步扩展这些示例以满足你的具体需求。不同的情况下可能需要更多的格式化和数据处理操作。